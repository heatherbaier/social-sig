## SocialSigNet

<br>

### Description of models

#### *socialSig - No reorientation*
This is a near-classic resNet18 model that takes as input the image created from imputing the values of a social signature without ever reorienting the image (i.e. the order of the positioning of the variables is the same as their order in the original dataframe). 

#### *socialSig - No Drop*
The re-organization of the indices does not allow for dropping and repetitition. The the index values are any 0:len(input) and are generated by assigning each weights with its index in a sorted list.

#### *socialSig - Drop*
The re-organization of the indices in the social signature prior to imputation allows for the dropping and repetition of variables.

#### *socialSigNeighbors - value-based*
The orientation of the image is by values. Each 3x3 group of pixels in the input array represents the value of one variable for the target municiaplity and its neighbors.

#### *socialSigNeighbors - space-based*
The orientation of the image is by s[patial orentation]. The image is made up of 9 nXn matrices that represent the social signatures of the target municipality and its neighboring municipalities. Data is not grouped by value, but instead by it's approximate orientation on a map.

<br>

### Files:
1) working.py: code to create social signatures
2) createFootprints.py: code to create images of each row in us_migration.csv based on trained weights from working.py
3) resnsetWorking.py: uses slightly modified resnset18 archtiecture to train model based on social signature images created in createFootprints.py
4) nn_dt_rf_knn.py: Trains traditional models for comparison to socialSig

<br>

### Helper Files:
a) helpers.py: ssorted helper functions used throughout all files
b) resnet18.py: Architecture used to train model on socialSig footprint images (TODO: Make responsive to user input sizes)
c) socialSig.py: Architecture used to train model for creating socialSigs


<br>
<br>

### Current Results


|       Model	    |       MAE	     |          R2	     |  Quantity Error	|  Allocation Error  |
|-------------------|----------------|-------------------|------------------|--------------------|
| socialSigNet	    |   215.1286552	 |   -0.1594528512	 |   54721.64644	|    118.960101      |
| Decision Tree	    |   193.0494624	 |    0.1808922845	 |   34610	        |    74.43010753     |
| KNN	            |   261.388172	 |    0.03378865814	 |   18915.5	    |    40.67849462     |
| Random Forest	    |   208.8401289	 |    0.1880718695	 |   2935.635962	|    6.313195617     |
| Neural Network	|   233.4912048	 |    0.09794770185	 |   3512.248738	|    7.553223093     |

<br>
<br>



### Model Plots

#### Random Forest
<img src = "./model_plots/RF.png">


#### Decision Tree
<img src = "./model_plots/DT.png">


#### MLP
<img src = "./model_plots/MLP.png">


#### KNN
<img src = "./model_plots/KNN.png">


#### socialSig
<img src = "./model_plots/socialSig.png">





##### Setting up conda env with Jupyter
conda activate caoe
conda install -c anaconda ipykernel
python -m ipykernel install --user --name=caoe
